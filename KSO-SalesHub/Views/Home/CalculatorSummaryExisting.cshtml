@using KSO_SalesHub.Models.Simulation;
@model SimulationContainer;
@{
	Layout = null;
}

<!DOCTYPE html>
<html>
<head>
	<title>Internal Summary Calculator</title>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="icon" href="~/assets/images/logo_ptm.png" type="image/x-icon">
	@Html.Partial("Partial/_SimulationFakeCSS")
	@Html.Partial("Partial/_SimulationFakeJS")
</head>
<body class="">
	<div class="main-wrapper" id="app">
		<div class="page-wrapper full-page">
			<div class="page-content d-flex align-items-center justify-content-center body-background px-0 py-1">
				<div class="row w-100 mx-0" id="calculator_content">
					<div class="col-md-12 col-xl-12 mx-auto">
						<div class="card custom-border">
							<div class="row pb-2">
								<div class="col-md-12 d-none">
									<div class="auth-left-wrapper" style="background-image: url('/assets/images/login_frame.png')">
									</div>
								</div>
								<div class="col-md-12">
									<div class="auth-form-wrapper p-2 py-0">
										<div class="mb-0 pt-4 ps-5 pb-4" ps-4>
											<img src="~/assets/images/ptpr-no-text.png" alt="logo" style="width: 50px;">
											<span class="text-secondary">
												<h4 class="mt-2"><strong>SUMMARY CALCULATOR INTERNAL</strong></h4>
												<h5 class="text-muted fw-normal mb-0">Simulate your SPBU profits and earnings with one easy step.</h5>
											</span>
										</div>
										<div class="card mb-2">
											<div class="card-body p-3 ps-5">
												<div class="row ">
													<div class="col-sm-12">
														<div class="container">
															<div class="row mb-1 font-12">
																<div class="col-2 bot-border py-2"><strong>Resume Kelayakan</strong></div>
																<div class="col-3 bot-border py-2" colspan="3">
																	: <span class="badge rounded-pill bg-success" style="font-size: 12px;"> &nbsp;&nbsp; @Model.ResultCalculator.ResumeKelayakan &nbsp;&nbsp;</span>
																</div>
															</div>
															<div class="row mb-1 font-12">
																<div class="col-2 bot-border"><strong>Nomor SPBU</strong></div>
																<div class="col-3 bot-border">: @Model._calculator.NomorSPBU</div>
																<div class="col-3 bot-border ms-3"><strong>Tipe / Grading SPBU</strong></div>
																<div class="col-3 bot-border">: @Model._calculator.SPBUGrading / @Model._calculator.SPBUType</div>
															</div>
															<div class="row mb-1 font-12">
																<div class="col-2 bot-border"><strong>Prop. Sharing Margin Mitra</strong></div>
																<div class="col-3 bot-border">: @Model.ResultCalculator.PropSharingMarginMitra %</div>
																<div class="col-3 bot-border ms-3"><strong>Jenis Produk BBM</strong></div>
																<div class="col-3 bot-border">: @Model.ResultCalculator.ProductBBMPercentage %</div>
															</div>
															<div class="row mb-1 font-12">
																<div class="col-2 bot-border"><strong>Prop. Sharing Margin PTPR</strong></div>
																<div class="col-3 bot-border">: @Model.ResultCalculator.PropSharingMarginPTPR %</div>
																<div class="col-3 bot-border ms-3"><strong>Jenis Produk BBK</strong></div>
																<div class="col-3 bot-border">: @Model.ResultCalculator.ProductBBKPercentage %</div>
															</div>
															<div class="row mb-1 font-12">
																<div class="col-2 bot-border"><strong>UMK</strong></div>
																<div class="col-3 bot-border">: @Model._calculator.UMK</div>
																<div class="col-3 bot-border ms-3"><strong>Status Pajak</strong></div>
																<div class="col-3 bot-border">: @Model._calculator.TaxStatus</div>
															</div>
															<div class="row mb-1 font-12">
																<div class="col-2 bot-border"><strong>Profit (Exclude OH)</strong></div>
																<div class="col-3 bot-border" id="TotalProfitExOHCurency">: </div>
																<div class="col-3 bot-border ms-3"><strong>Opex Exclude Tax</strong></div>
																<div class="col-3 bot-border" id="TotalOpexExTaxCurency">: </div>
															</div>
															<div class="row mb-1 font-12">
																<div class="col-2 bot-border"><strong>PPN 11%</strong></div>
																<div class="col-3 bot-border" id="TotalPPN11Curency">: </div>
																<div class="col-3 bot-border ms-3"><strong>Profit (Exclude Selisih Single Margin)</strong></div>
																<div class="col-3 bot-border" id="TotalProfitExSSMCurency">: </div>
															</div>
															<div class="row mb-1 font-12">
																<div class="col-2 bot-border"><strong>Profit (Include OH)</strong></div>
																<div class="col-3 bot-border" id="TotalProfitInOHCurency">: </div>
															</div>
														</div>
													</div>
												</div>
											</div>
										</div>
										<div class="card mb-0">
											<div class="card-body p-4">
												<div class="row ">
													<div class="col-sm-12">
														<div class="table-responsive">
															<table class="table table-striped table-sm table-bordered">
																<thead>
																	<tr>
																		<th colspan="1" rowspan="2" class="text-center align-middle px-3 font-10">#</th>
																		<th colspan="1" rowspan="2" class="text-center align-middle px-3 font-10">Product</th>
																		<th colspan="1" rowspan="2" class="text-center align-middle px-3 font-10">Sales Monthly <br /> (Liter)</th>
																		<th colspan="1" rowspan="2" class="text-center align-middle px-3 font-10">Sales Per Day <br /> (Liter)</th>
																		<th colspan="1" rowspan="2" class="text-center align-middle px-3 font-10">Price Currency</th>
																		<th colspan="1" rowspan="2" class="text-center align-middle px-3 font-10">Monthly Sales Currency</th>
																		<th colspan="2" rowspan="1" class="font-10">Margin Dodo / Codo</th>
																		<th colspan="1" rowspan="2" class="text-center align-middle px-3 font-10">Margin PTPR</th>
																		<th colspan="2" rowspan="1" class="font-10">Selisih Single Margin</th>
																		<th colspan="1" rowspan="2" class="text-center align-middle px-3 font-10">Basic Price</th>
																		<th colspan="1" rowspan="2" class="text-center align-middle px-3 font-10">PPH 22 </th>
																		<th colspan="1" rowspan="2" class="text-center align-middle px-3 font-10">Overhead HO <br /> (Rp. 15,- per Liter) </th>
																		<th colspan="1" rowspan="2" class="text-center align-middle px-3 font-10">Gross Margin <br /> Monthly SPBU </th>
																		@* <th colspan="3" rowspan="1" class="text-center align-middle px-3 font-10">Margin</th> *@
																		<th colspan="1" rowspan="2" class="text-center align-middle px-3 font-10">SHARING MITRA </th>
																	</tr>
																	<tr>
																		<th colspan="1" class="font-10"> Normal</th>
																		<th colspan="1" class="font-10"> Normal + 5</th>
																		<th colspan="1" class="font-10"> Normal</th>
																		<th colspan="1" class="font-10"> Normal + 5</th>
																		@* <th colspan="1" class="font-10"> SELISIH SINGLE MARGIN </th>
																		<th colspan="1" class="font-10"> SHARING  PTPR</th>
																		<th colspan="1" class="font-10"> GROSS MARGIN PTPR</th> *@
																	</tr>
																</thead>
																<tbody>
																	@for (int i = 0; i < Model.ResultCalculator.DetailSummary.Count; i++)
																	{
																		var item = Model.ResultCalculator.DetailSummary[i];
																		<tr>
																			<th class="font-10">@(i + 1)</th>
																			<th class="font-10">@item.ProductName</th>
																			<td class="font-10">@item.SalesMonthly</td>
																			<td class="font-10">@item.SalesPerDay</td>
																			<td class="font-10 currency">@item.PriceCurrency</td>
																			<td class="font-10 currency">@item.MonthlySalesCurency</td>
																			<td class="font-10 currency">@item.MarginDodoCodoNormal</td>
																			<td class="font-10 currency">@item.MarginDodoCodoNormalAdding5</td>
																			<td class="font-10 currency">@item.MarginPTPR</td>
																			<td class="font-10 currency">@item.SelisihSingleMarginNormal</td>
																			<td class="font-10 currency">@item.SelisihSingleMarginAdding5</td>
																			<td class="font-10 currency">@item.BasicPrice</td>
																			<td class="font-10 currency">@item.PPH22Currency</td>
																			<td class="font-10 currency">@item.OverHeadHOCurrency</td>
																			<td class="font-10 currency">@item.GrossMarginMonthlySpbuCurrency</td>
																			@* <td class="font-10 currency">@item.MarginSelisihSingleMarginCurrency</td>
																		<td class="font-10 currency">@item.MarginSharingPTPRCurrency</td>
																		<td class="font-10 currency">@item.MarginGrossMarginPTPRCurrency</td> *@
																			<td class="font-10 currency">@item.SharingMitraCurrency</td>
																		</tr>
																	}
																</tbody>
																<tfoot>
																	<tr style=" font-weight:bolder;">
																		<th class="font-10">#</th>
																		<th class="font-10"> Total</th>
																		<td class="font-10">@Model.ResultCalculator.DetailSummary.Select(x => x.SalesMonthly).Sum()</td>
																		<td class="font-10">@Model.ResultCalculator.DetailSummary.Select(x => x.SalesPerDay).Sum()</td>
																		<td class="font-10 currency">@Model.ResultCalculator.DetailSummary.Select(x => x.PriceCurrency).Sum()</td>
																		<td class="font-10 currency">@Model.ResultCalculator.DetailSummary.Select(x => x.MonthlySalesCurency).Sum()</td>
																		<td class="font-10" colspan="5"></td>
																		<td class="font-10 currency">@Model.ResultCalculator.DetailSummary.Select(x => x.BasicPrice).Sum()</td>
																		<td class="font-10 currency">@Model.ResultCalculator.DetailSummary.Select(x => x.PPH22Currency).Sum()</td>
																		<td class="font-10 currency">@Model.ResultCalculator.DetailSummary.Select(x => x.OverHeadHOCurrency).Sum()</td>
																		<td class="font-10 currency">@Model.ResultCalculator.DetailSummary.Select(x => x.GrossMarginMonthlySpbuCurrency).Sum()</td>
																		@* <td class="font-10 currency">@Model.ResultCalculator.DetailSummary.Select(x => x.MarginSelisihSingleMarginCurrency).Sum()</td>
																		<td class="font-10 currency">@Model.ResultCalculator.DetailSummary.Select(x => x.MarginSharingPTPRCurrency).Sum()</td>
																		<td class="font-10 currency">@Model.ResultCalculator.DetailSummary.Select(x => x.MarginGrossMarginPTPRCurrency).Sum()</td> *@
																		<td class="font-10 currency">@Model.ResultCalculator.DetailSummary.Select(x => x.SharingMitraCurrency).Sum()</td>
																	</tr>
																</tfoot>
															</table>
														</div>
													</div>
												</div>
											</div>
										</div>
										<div class="card mt-1">
											<div class="card-body p-3">
												<div class="row">
													<div class="col-md-6 text-start">
													</div>
													<div class="col-md-6 text-end">
														<a href="~/download-summary-internal?SummaryID=@Model.ResultCalculator.SummaryNo" class="btn btn-success">
															<i class="btn-icon-prepend" data-feather="download"></i>
															Download
														</a>

														<a href="~/admin-panel" class="btn btn-danger">
															<i class="btn-icon-prepend" data-feather="arrow-left-circle"></i>
															Kembali
														</a>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			@Html.Partial("Partial/_Footer")
		</div>
	</div>
</body>
</html>

<script>
	$(document).ready(function () {

		const TotalOpexExTaxCurency = '@Model.ResultCalculator.TotalOpexExTaxCurency';
		const TotalPPN11Curency = '@Model.ResultCalculator.TotalPPN11Curency';
		const TotalProfitExSSMCurency = '@Model.ResultCalculator.TotalProfitExSSMCurency';
		const TotalProfitInOHCurency = '@Model.ResultCalculator.TotalProfitInOHCurency';
		const TotalProfitExOHCurency = '@Model.ResultCalculator.TotalProfitExOHCurency';

		formatAndAppendCurrency('TotalOpexExTaxCurency', TotalOpexExTaxCurency);
		formatAndAppendCurrency('TotalPPN11Curency', TotalPPN11Curency);
		formatAndAppendCurrency('TotalProfitExSSMCurency', TotalProfitExSSMCurency);
		formatAndAppendCurrency('TotalProfitInOHCurency', TotalProfitInOHCurency);
		formatAndAppendCurrency('TotalProfitExOHCurency', TotalProfitExOHCurency);
	});
</script>

